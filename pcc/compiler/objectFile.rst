The Elf file format
++++++++++++++++++++
This guide is aimed to explain the ELF format using a simple example.

Introduction
=============
I based my explanation on this document.
https://www.uclibc.org/docs/elf-64-gen.pdf

I will be using the following source code snippet as example. I will assume
that it is saved as `test.c`

.. code-block:: c

    // a global variable
    char name[] = "test\n";


Hex contents of a ELF file
==========================

I compiled this examples with.

::

    gcc -c test.c

This generates 'test.o', which is formatted for my in the ELF format. But how do
I know and can you check of you? Well you can inspect the file by dumping the
content. I used:

::

    hd test.o

This generated the following content:

::

    00000000  7f 45 4c 46 02 01 01 00  00 00 00 00 00 00 00 00  |.ELF............|
    00000010  01 00 3e 00 01 00 00 00  00 00 00 00 00 00 00 00  |..>.............|
    00000020  00 00 00 00 00 00 00 00  90 01 00 00 00 00 00 00  |................|
    00000030  00 00 00 00 40 00 00 00  00 00 40 00 09 00 08 00  |....@.....@.....|
    00000040  74 65 73 74 0a 00 00 47  43 43 3a 20 28 55 62 75  |test...GCC: (Ubu|
    00000050  6e 74 75 20 37 2e 33 2e  30 2d 32 37 75 62 75 6e  |ntu 7.3.0-27ubun|
    00000060  74 75 31 7e 31 38 2e 30  34 29 20 37 2e 33 2e 30  |tu1~18.04) 7.3.0|
    00000070  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
    00000080  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
    00000090  01 00 00 00 04 00 f1 ff  00 00 00 00 00 00 00 00  |................|
    000000a0  00 00 00 00 00 00 00 00  00 00 00 00 03 00 01 00  |................|
    000000b0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
    000000c0  00 00 00 00 03 00 02 00  00 00 00 00 00 00 00 00  |................|
    000000d0  00 00 00 00 00 00 00 00  00 00 00 00 03 00 03 00  |................|
    000000e0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
    000000f0  00 00 00 00 03 00 05 00  00 00 00 00 00 00 00 00  |................|
    00000100  00 00 00 00 00 00 00 00  00 00 00 00 03 00 04 00  |................|
    00000110  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
    00000120  08 00 00 00 11 00 02 00  00 00 00 00 00 00 00 00  |................|
    00000130  06 00 00 00 00 00 00 00  00 74 65 73 74 2e 63 00  |.........test.c.|
    00000140  6e 61 6d 65 00 00 2e 73  79 6d 74 61 62 00 2e 73  |name...symtab..s|
    00000150  74 72 74 61 62 00 2e 73  68 73 74 72 74 61 62 00  |trtab..shstrtab.|
    00000160  2e 74 65 78 74 00 2e 64  61 74 61 00 2e 62 73 73  |.text..data..bss|
    00000170  00 2e 63 6f 6d 6d 65 6e  74 00 2e 6e 6f 74 65 2e  |..comment..note.|
    00000180  47 4e 55 2d 73 74 61 63  6b 00 00 00 00 00 00 00  |GNU-stack.......|
    00000190  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
    000001A0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
    000001B0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
    000001C0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
    000001d0  1b 00 00 00 01 00 00 00  06 00 00 00 00 00 00 00  |................|
    000001e0  00 00 00 00 00 00 00 00  40 00 00 00 00 00 00 00  |........@.......|
    000001f0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
    00000200  01 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
    00000210  21 00 00 00 01 00 00 00  03 00 00 00 00 00 00 00  |!...............|
    00000220  00 00 00 00 00 00 00 00  40 00 00 00 00 00 00 00  |........@.......|
    00000230  06 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
    00000240  01 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
    00000250  27 00 00 00 08 00 00 00  03 00 00 00 00 00 00 00  |'...............|
    00000260  00 00 00 00 00 00 00 00  46 00 00 00 00 00 00 00  |........F.......|
    00000270  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
    00000280  01 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
    00000290  2c 00 00 00 01 00 00 00  30 00 00 00 00 00 00 00  |,.......0.......|
    000002a0  00 00 00 00 00 00 00 00  46 00 00 00 00 00 00 00  |........F.......|
    000002b0  2b 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |+...............|
    000002c0  01 00 00 00 00 00 00 00  01 00 00 00 00 00 00 00  |................|
    000002d0  35 00 00 00 01 00 00 00  00 00 00 00 00 00 00 00  |5...............|
    000002e0  00 00 00 00 00 00 00 00  71 00 00 00 00 00 00 00  |........q.......|
    000002f0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
    00000300  01 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
    00000310  01 00 00 00 02 00 00 00  00 00 00 00 00 00 00 00  |................|
    00000320  00 00 00 00 00 00 00 00  78 00 00 00 00 00 00 00  |........x.......|
    00000330  c0 00 00 00 00 00 00 00  07 00 00 00 07 00 00 00  |................|
    00000340  08 00 00 00 00 00 00 00  18 00 00 00 00 00 00 00  |................|
    00000350  09 00 00 00 03 00 00 00  00 00 00 00 00 00 00 00  |................|
    00000360  00 00 00 00 00 00 00 00  38 01 00 00 00 00 00 00  |........8.......|
    00000370  0d 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
    00000380  01 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
    00000390  11 00 00 00 03 00 00 00  00 00 00 00 00 00 00 00  |................|
    000003a0  00 00 00 00 00 00 00 00  45 01 00 00 00 00 00 00  |........E.......|
    000003b0  45 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |E...............|
    000003c0  01 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
    000003d0


Elf format overview
====================

You see that the ASCII interpretation already lists ELF, which seems to hint on
the ELF format. But lets not get ahead of ourselves.

An elf file consists out of a header, and then the sections or segments
depending on the type of of file, executable or linkable. Most important thing
is that the file always start with the elf header. So we can check if our file
has the correct header.


Elf Header
==========

Interpreting the hex dump from above, we can construct the following table

+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
| address  |  0   |  1   |  2   |  3   |  4    |  5   |  6      |   7   |  8         |  9   |  10  | 11   | 12   | 13   |  14  | 15   | asccii interpretation |
+==========+======+======+======+======+=======+======+=========+=======+============+======+======+======+======+======+======+======+=======================+
|          | MAG0 | MAG1 | MAG2 | MAG3 | CLASS | DATA | VERSION | OSABI | ABIVERSION |      |      |      |      |      |      |      |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
| 00000000 | 7F   | 45   | 4C   | 46   | 02    | 01   | 01      | 00    | 00         | 00   |  00  | 00   | 00   | 00   | 00   | 00   | *.ELF............*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          | type        | machine     | version                        | entry                                                       |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
| 00000010 |  01  |   00 |   3E |   00 |    01 |  00  |   00    | 00    | 00         |  00  |   00 |  00  |   00 |  00  |   00 |  00  | *..>.............*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          | phoff                                                      | shoff                                                       |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
| 00000020 |  00  |  00  |  00  |  00  |  00   | 00   | 00      | 00    |  90        |  01  |  00  |  00  |  00  |  00  |  00  |  00  | *................*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          | flags                     |  ehsize      | phentsize       | phnum             | shentsize   |  shnum      |   shstrndx  |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
| 00000030 | 00   | 00   | 00   | 00   | 40    | 00   | 00      | 00    | 00         |  00  |  40  |  00  |  09  |  00  |  08  |   00 | *....@.....@.....*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+

The first 4 bytes are MAG0 to MAG3, and are required to be ‘0x7f’, ‘E’, ‘L’,
and ‘F’. THis is the case for our file, so it is a elf file. The class is 2, so
it is ELFCLASS64. And not ELFCLASS32. Data is 1, so it is ELFDATA2LSB. We
should interpreted the data as being little endian (least significant byte at
the lower addresses). VERSION is 1 as the current version (there have not been
updates to my knowledge). OSABI is 0, using the System V ABI (ELFOSABI_SYSV).
The ABIVERSION is set to 0, as required for the System V ABI. The other bytes
in the 16 byte e_ident, do not have a meaning for our configuration.

As we know the endianess, it is possible from now on to specify field longer
than 1 byte. The type is 1, so ET_REL. It is a relocatable file, which is what
we expect, as it only contains a global variable. Machine is 003E, which we
can find back on http://refspecs.linuxbase.org/elf/gabi4+/ch4.eheader.html.
The decimal interpretation is 62. On the web page it is listed as EM_X86_64:
AMD x86-64 architecture. This is indeed the case. I ran the test on a 64 bit
Intel CPU. Version is 1 as mandated. Entry is 0, as the elf file has no entry
point because it is not an executable.

Now the program and section header offsets. Phoff is 0 and shoff is 0x190.
Flags is 0. Ehsize is 0x40, the header contains 64 bytes. phentsize is 0 so 
each entry in the program header table is 0 bytes. Phnum is 0, so there are
no entries in the program header table. Shentsize so each entry of the section
header table is 64 bytes. Shnum is 9 so there are 9 section in the section
header. Shstrndx is 8 so the section at index is 8 contains the string table.
This is the last entry in our table, the 9th entry.

So the next interesting part is Section header table at address 0x190.


Elf Section Header Table
========================

You can find the interpretation of the section header table below.

+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
| address  |  0   |  1   |  2   |  3   |  4    |  5   |  6      |   7   |  8         |  9   |  10  | 11   | 12   | 13   |  14  | 15   | ascii interpretation  |
+==========+======+======+======+======+=======+======+=========+=======+============+======+======+======+======+======+======+======+=======================+
|**Sect 0**| sh_name                   | sh_type                |   sh_flags                                                          |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
| 00000190 | 00   | 00   |  00  |   00 |    00 |   00 |   00    |  00   | 00         | 00   | 00   | 00   |  00  |   00 |  00  |   00 | *................*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          | sh_addr                                            | sh_offset                                                           |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|000001A0  | 00   | 00   |  00  |  00  |  00   | 00   |  00     | 00    | 00         |   00 |   00 |   00 |   00 |   00 |   00 |   00 | *................*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          | sh_size                                            |   sh_link                        |  sh_info                         |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|000001B0  | 00   | 00   | 00   | 00   | 00    |  00  |  00     | 00    | 00         | 00   | 00   | 00   | 00   | 00   | 00   | 00   | *................*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          |sh_addralign                                        |   sh_entsize                                                        |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|000001C0  | 00   | 00   | 00   | 00   | 00     | 00  |  00     | 00    |  00        | 00   | 00   | 00   | 00   | 00   | 00   | 00   | *................*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|**Sect 1**| sh_name                   | sh_type                |   sh_flags                                                          |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|000001D0  | 1B   | 00   | 00   | 00   | 01    |  00  |  00     |  06   | 00         |  00  |  00  |  00  |   00 |  00  |  00  |  00  | *................*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          |sh_addr                                             |   sh_offset                                                         |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|000001E0  | 00   | 00   |  00  |   00 |    00 |   00 |   00    | 40    | 00         | 00   | 00   | 00   | 00   | 00   | 00   | 00   | *................*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          |sh_size                                             |   sh_link                        |   sh_info                        |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|000001F0  | 00   | 00   |  00  |   00 |    00 |   00 |   00    |  00   |  00        |  00  |  00  |   00 |   00 |  00  |  00  |   00 | *........@.......*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          |sh_addralign                                        |   sh_entsize                                                        |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|00000200  | 01   | 00   | 00   |  00  |   00  |   00 |    00   |  00   |  00        | 00   | 00   |  00  |   00 |   00 |   00 |   00 | *................*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|**Sect 2**| sh_name                   | sh_type                |   sh_flags                                                          |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|00000210  | 21   | 00   | 00   | 00   | 01    |  00  |  00     | 03    |  00        |  00  |   00 |   00 |   00 |  00  |  00  |  00  | *!...............*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          | sh_addr                                            | sh_offset                                                           |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|00000220  | 00   | 00   |  00  |   00 |    00 |  00  |  00     | 40    |  00        | 00   | 00   |  00  |  00  |  00  |  00  |  00  | *........@.......*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          |sh_size                                             |   sh_link                        |   sh_info                        |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|00000230  | 06   | 00   |  00  |   00 |   00  |  00  |  00     |  00   | 00         | 00   | 00   |  00  |  00  |  00  |  00  |  00  | *................*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          |sh_addralign                                        |   sh_entsize                                                        |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|00000240  | 01   |  00  |   00 |   00 |   00  |  00  |  00     | 00    |  00        | 00   |  00  |   00 |  00  |   00 |   00 |   00 | *................*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|**Sect 3**| sh_name                   | sh_type                |   sh_flags                                                          |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|00000250  | 27   |  00  |   00 |   00 |    08 |   00 |    00   |  03   |  00        | 00   |  00  |   00 |   00 |  00  |   00 |  00  | *'...............*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          | sh_addr                                            | sh_offset                                                           |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|00000260  | 00   |  00  |   00 |   00 |    00 |   00 |    00   |  46   |  00        | 00   |  00  |   00 |   00 |  00  |   00 |  00  | *........F.......*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          |sh_size                                             |   sh_link                        |   sh_info                        |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|00000270  | 00   |  00  |   00 |   00 |    00 |   00 |    00   |  00   |  00        | 00   |  00  |   00 |   00 |  00  |   00 |  00  | *................*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          |sh_addralign                                        |   sh_entsize                                                        |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|00000280  | 01   |  00  |   00 |   00 |    00 |   00 |    00   |  00   |  00        | 00   |  00  |   00 |   00 |  00  |   00 |  00  | *................*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|**Sect 4**| sh_name                   | sh_type                |   sh_flags                                                          |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|00000290  | 2C   |  00  |  00  |   00 |    01 |   00 |   00    | 03    | 00         | 00   |  00  |   00 |  00  |   00 |   00 |   00 | *,.......0.......*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          | sh_addr                                            | sh_offset                                                           |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|000002A0  | 00   |  00  |  00  |   00 |    00 |   00 |   00    | 46    | 00         | 00   |  00  |   00 |  00  |   00 |   00 |   00 | *........F.......*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          |sh_size                                             |   sh_link                        |   sh_info                        |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|000002B0  | 2B   |  00  |  00  |   00 |    00 |   00 |   00    | 00    | 00         | 00   |  00  |   00 |  00  |   00 |   00 |   00 | *+...............*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          |sh_addralign                                        |   sh_entsize                                                        |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|000002C0  | 01   |  00  |  00  |   00 |    00 |   00 |   00    | 01    | 00         | 00   |  00  |   00 |  00  |   00 |   00 |   00 | *................*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|**Sect 5**| sh_name                   | sh_type                |   sh_flags                                                          |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|000002D0  | 35   |  00  |  00  |   00 |    01 |   00 |   00    | 00    | 00         | 00   |  00  |   00 |  00  |   00 |   00 |   00 | *5...............*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          | sh_addr                                            | sh_offset                                                           |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|000002E0  | 00   |  00  |  00  |   00 |    00 |   00 |   00    | 71    | 00         | 00   |  00  |   00 |  00  |   00 |   00 |   00 | *........q.......*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          |sh_size                                             |   sh_link                        |   sh_info                        |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|000002F0  | 00   |  00  |  00  |   00 |    00 |   00 |   00    | 00    | 00         | 00   |  00  |   00 |  00  |   00 |   00 |   00 | *................*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          |sh_addralign                                        |   sh_entsize                                                        |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|00000300  | 01   |  00  |  00  |   00 |    00 |   00 |   00    | 00    | 00         | 00   |  00  |   00 |  00  |   00 |   00 |   00 | *................*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|**Sect 6**| sh_name                   | sh_type                |   sh_flags                                                          |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|00000310  | 01   |  00  |  00  |   00 |    02 |   00 |   00    | 00    | 00         | 00   |  00  |   00 |  00  |   00 |   00 |   00 | *................*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          | sh_addr                                            | sh_offset                                                           |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|00000320  | 00   |  00  |  00  |   00 |    00 |   00 |   00    | 78    | 00         | 00   |  00  |   00 |  00  |   00 |   00 |   00 | *........x.......*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          |sh_size                                             |   sh_link                        |   sh_info                        |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|00000330  | C0   |  00  |  00  |   00 |    00 |   00 |   00    | 07    | 00         | 00   |  00  |   07 |  00  |   00 |   00 |   00 | *................*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          |sh_addralign                                        |   sh_entsize                                                        |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|00000340  | 08   |  00  |  00  |   00 |    00 |   00 |   00    | 18    | 00         | 00   |  00  |   00 |  00  |   00 |   00 |   00 | *................*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|**Sect 7**| sh_name                   | sh_type                |   sh_flags                                                          |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|00000350  | 09   |  00  |  00  |   00 |    03 |   00 |   00    | 00    | 00         | 00   |  00  |   00 |  00  |   00 |   00 |   00 | *................*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          | sh_addr                                            | sh_offset                                                           |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|00000360  | 00   |  00  |  00  |   00 |    00 |   00 |   00    | 38    |       01   |  00  |   00 |  00  |   00 |   00 |   00 |      | *........8.......*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          |sh_size                                             |   sh_link                        |   sh_info                        |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|00000370  | 0D   |  00  |  00  |   00 |    00 |   00 |   00    | 00    | 00         | 00   |  00  |   00 |  00  |   00 |   00 |   00 | *................*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          |sh_addralign                                        |   sh_entsize                                                        |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|00000380  | 01   |  00  |  00  |   00 |    00 |   00 |   00    | 00    | 00         | 00   |  00  |   00 |  00  |   00 |   00 |   00 | *................*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|**Sect 8**| sh_name                   | sh_type                |   sh_flags                                                          |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|00000390  | 11   |  00  |  00  |   00 |    03 |   00 |   00    | 00    | 00         | 00   |  00  |   00 |  00  |   00 |   00 |   00 | *................*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          | sh_addr                                            | sh_offset                                                           |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|000003A0  | 00   |  00  |  00  |   00 |    00 |   00 |   00    | 45    |  01        | 00   |  00  |   00 |  00  |   00 |   00 |   00 | *........E.......*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          |sh_size                                             |   sh_link                        |   sh_info                        |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|000003B0  | 45   |  00  |  00  |   00 |    00 |   00 |   00    | 00    | 00         | 00   |  00  |   00 |  00  |   00 |   00 |   00 | *E...............*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          |sh_addralign                                        |   sh_entsize                                                        |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|000003C0  | 01   |  00  |  00  |   00 |    00 |   00 |   00    | 00    | 00         | 00   |  00  |   00 |  00  |   00 |   00 |   00 | *................*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+

Section 8
---------

We start with the last section as it contains the string table contents (see
the elf header). The sh_offset is 0x0145. So the string table is located a
offset 325 from the start of the file. And the sh_size is 0x45. The content is
copied below.

+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
| address  |  0   |  1   |  2   |  3   |  4    |  5   |  6      |   7   |  8         |  9   |  10  | 11   | 12   | 13   |  14  | 15   | asccii interpretation |
+==========+======+======+======+======+=======+======+=========+=======+============+======+======+======+======+======+======+======+=======================+
|00000140  |      |      |      |      |       |  00  |  2E     | 73    |79          |   6D |  74  |  61  |  62  |  00  |  2E  |  73  | *.......symtab..s*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|00000150  |  74  |   72 |  74  |  61  |   62  |  00  |  2E     | 73    |68          |   73 |  74  |  72  |  74  |  61  |  62  |  00  | *trtab..shstrtab.*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|00000160  |  2E  |   74 |  65  |  78  |   74  |  00  |  2E     | 64    |61          |   74 |  61  |  00  |  2E  |  62  |  73  |  73  | *.text..data..bss*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|00000170  |  00  |   2E |  63  |  6F  |   6D  |  6D  |  65     | 6E    |74          |   00 |  2E  |  6E  |  6F  |  74  |  65  |  2E  | *..comment..note.*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|00000180  |  47  |  4E  |  55  |  2D  |  73   | 74   | 61      |  63   | 6B         | 00   | 00   | 00   | 00   | 00   | 00   | 00   | *GNU-stack.......*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+

Sh_name is 0x11 so the name starts at 0x145 + 0x11 = 0x156. The name string is
2E, 73, 68, 73, 74, 72, 74, 61, 62, 00 (shstrtab). The strings are NULL
terminated. So read until the 0 byte. For this section the name is shstrtab,
which is short for Section Header String Table. This makes sense.


Sh_type is 0x3, SHT_STRTAB. SH_flags is 0, so no flags for this section.
Sh_addr is 0 as it does not contain a image that needs in memory. Sh_link is 0,
so it is not linked to other sections. Sh_info is 0, so no additional
information. Sh_addralign is 1, the section alignment is byte aligned.
Sh_entsize is 0 as it is not a fixed size entry.



Section 0
---------

Section 0 is required to contain all 0's. No real information.


Section 1
---------

name = 0x1B
type = 1
flags = 0x6
address = 0
offset = 0x40
size = 0
link = 0
info = 0
align = 1
entry size = 0

The name is located at 0x145 + 0x1b (2e 74 65 78 74 00) or ".text". The type is
1 or SHT_PROGBITS, meaning program defined. The flags field is 6, so
SHF_ALLOC(2) and SHF_EXECINSTR(4) are set. The section is allocated inside the
program and contains executable instructions. The contents of the section are
located at byte offset 0x40, which is directly after the elf header in our
example. But the size is 0 so no contents. Our code example did not have any
executable code, so this is as expected. No other relevant information.


Section 2
---------

name = 0x21
type = 1
flags = 0x3
address = 0
offset = 0x40
size = 6
link = 0
info = 0
align = 1
entry size = 0

The name is located at 0x145 + 0x21 = 0x166 (2e 64  61 74 61 00) or ".data".
The type is again SHT_PROGBITS, the flags for SHF_WRITE(1) and SHF_ALLOC(2) are
set. The section contains writable data allocated in the program. The size is
6 and it is located at byte offset 0x40. This is (74 65 73 74 0a 00). This is
the ascii string "test\\n". .data contains writable data for the
program.


Section 3
---------

name = 0x27
type = 1
flags = 0x3
address = 0
offset = 0x46
size = 0
link = 0
info = 0
align = 1
entry size = 0

The name is located at 0x145 + 0x27 = 0x16c (2e 62 73 73 00) or ".bss". The
type is again SHT_PROGBITS, the flags for SHF_WRITE(1) and SHF_ALLOC(2) are
set. The size is 0, so there is no content for our example. The section
contains writable data allocated in the program.

Section 4
---------

name = 0x2c
type = 1
flags = 0x3
address = 0
offset = 0x46
size = 0x2B
link = 0
info = 0
align = 1
entry size = 1

The name is located at 0x145 + 0x2c = 0x171 (2e 63 6f 6d 6d 65 6e 74 00) or
".comment". The type is again SHT_PROGBITS, and the flags for SHF_WRITE(1)
and SHF_ALLOC(2) are set. At offset 0x46 there are 0x2b bytes. The size of the
entry is 1. THe .comment section typically contains version control information.
The contents of that sections are:

47 43 43 3a 20 28 55 62 75 6e 74 75 20 37 2e 33 2e 30 2d 32 37 75 62 75 6e
74 75 31 7e 31 38 2e 30  34 29 20 37 2e 33 2e 30 00

Which can be interpreted as
"GCC: (Ubuntu 7.3.0-27ubuntu1~18.04) 7.3.0"

Section 5
---------

name = 0x35
type = 1
flags = 0x0
address = 0
offset = 0x71
size = 0
link = 0
info = 0
align = 1
entry size = 0

The name is located at 0x145 + 0x35 = 0x17a (2e 6e 6f 74 65 2e 47 4e 55 2d 73
74 61 63  6b 00) or ".note.GNU-stack". The type is again SHT_PROGBITS, and
no flags are set. It does not have any contents.

Section 6
---------

name = 0x1
type = 2
flags = 0x0
address = 0
offset = 0x78
size = 0xc0
link = 0x7
info = 0x7
align = 8
entry size = 0x18

The name is located at 0x145 + 0x1 = 0x146 (2e 73  79 6d 74 61 62 00) or
".systab". The type is SHT_SYMTAB, and no flags are set. The contents are
located at byte offset 0x78 and the size is 0xc. This contains the linker
symbol table. It link to section 7, and info field is 7. The section is
aligned on a multiple of 8 bytes.

The size of an entry is 0x18. This is the expected size for a entry in the
symbol table. The size of the symbol table is 0xc0, so there are 8 elements
in the stable (0xc0/0x18 == 0x8). The raw dump is blow.


+----------+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+--------------------+
| address  |  0 |  1 |  2 |  3 |  4 |  5 |  6 | 7  |  8 | 9  | 10 | 11 | 12 | 13 | 14 | 15 | asccii             |
+==========+====+====+====+====+====+====+====+====+====+====+====+====+====+====+====+====+====================+
| 00000070 |    |    |    |    |    |    |    |    | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | *................* |
+----------+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+--------------------+
| 00000080 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | *................* |
+----------+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+--------------------+
| 00000090 | 01 | 00 | 00 | 00 | 04 | 00 | f1 | ff | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | *................* |
+----------+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+--------------------+
| 000000a0 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 03 | 00 | 01 | 00 | *................* |
+----------+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+--------------------+
| 000000b0 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | *................* |
+----------+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+--------------------+
| 000000c0 | 00 | 00 | 00 | 00 | 03 | 00 | 02 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | *................* |
+----------+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+--------------------+
| 000000d0 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 03 | 00 | 03 | 00 | *................* |
+----------+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+--------------------+
| 000000e0 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | *................* |
+----------+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+--------------------+
| 000000f0 | 00 | 00 | 00 | 00 | 03 | 00 | 05 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | *................* |
+----------+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+--------------------+
| 00000100 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 03 | 00 | 04 | 00 | *................* |
+----------+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+--------------------+
| 00000110 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | *................* |
+----------+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+--------------------+
| 00000120 | 08 | 00 | 00 | 00 | 11 | 00 | 02 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | *................* |
+----------+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+--------------------+
| 00000130 | 06 | 00 | 00 | 00 | 00 | 00 | 00 | 00 |    |    |    |    |    |    |    |    | *................* |
+----------+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+--------------------+


Symbol Entry 0
~~~~~~~~~~~~~~

The first entry needs to be completely zero. Which it is.

+----------+----+----+----+----+----+----+----+----+----+----+----+----+---------+----------+----+-----+--------------------+
| address  |  0 |  1 |  2 |  3 |  4 |  5 |  6 | 7  |  8 | 9  | 10 | 11 | 12      | 13       | 14 | 15  | asccii             |
+==========+====+====+====+====+====+====+====+====+====+====+====+====+=========+==========+====+=====+====================+
|          |                                       | st_name           | st_info | st_other | st_shndx |                    |
+----------+----+----+----+----+----+----+----+----+----+----+----+----+---------+----------+----+-----+--------------------+
| 00000070 |    |    |    |    |    |    |    |    | 00 | 00 | 00 | 00 | 00      | 00       | 00 | 00  | *................* |
+----------+----+----+----+----+----+----+----+----+----+----+----+----+---------+----------+----+-----+--------------------+
|          | st_value                              | st_size                                           |                    |
+----------+----+----+----+----+----+----+----+----+----+----+----+----+---------+----------+----+-----+--------------------+
| 00000080 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00      | 00       | 00 | 00  | *................* |
+----------+----+----+----+----+----+----+----+----+----+----+----+----+---------+----------+----+-----+--------------------+


Symbol Entry 1
~~~~~~~~~~~~~~

+----------+----+----+----+----+---------+----------+----+-----+----+----+----+----+----+----+----+----+--------------------+
| address  |  0 |  1 |  2 |  3 |  4      |  5       |  6 | 7   |  8 | 9  | 10 | 11 | 12 | 13 | 14 | 15 | asccii             |
+==========+====+====+====+====+=========+==========+====+=====+====+====+====+====+====+====+====+====+====================+
|          | st_name           | st_info | st_other | st_shndx | st_value                              |                    |
+----------+----+----+----+----+---------+----------+----+-----+----+----+----+----+----+----+----+----+--------------------+
| 00000090 | 01 | 00 | 00 | 00 | 04      | 00       | f1 | ff  | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | *................* |
+----------+----+----+----+----+---------+----------+----+-----+----+----+----+----+----+----+----+----+--------------------+
|          | st_size                                           |                                       |                    |
+----------+----+----+----+----+---------+----------+----+-----+----+----+----+----+----+----+----+----+--------------------+
| 000000a0 | 00 | 00 | 00 | 00 | 00      | 00       | 00 | 00  |    |    |    |    |    |    |    |    | *................* |
+----------+----+----+----+----+---------+----------+----+-----+----+----+----+----+----+----+----+----+--------------------+

The name is located at offset 1 w.r.t symbol string table. The symbol string
table can be found in `Section 7`_. At offset 1 we found the string "test.c".
The info is 4, meaning STT_FILE, so test.c was our source file for this object
file. The upper 4 bits are 0 so the binding is local. Other needs to be 0.
shndx is 0xfff1 or SHN_ABS, so the corresponding reference is absolute.
value is 0, as it is not used. size is also not used, and 0.

Symbol Entry 2
~~~~~~~~~~~~~~

+----------+----+----+----+----+----+----+----+----+----+----+----+----+---------+----------+----+-----+--------------------+
| address  |  0 |  1 |  2 |  3 |  4 |  5 |  6 | 7  |  8 | 9  | 10 | 11 | 12      | 13       | 14 | 15  | asccii             |
+==========+====+====+====+====+====+====+====+====+====+====+====+====+=========+==========+====+=====+====================+
|          |                                       | st_name           | st_info | st_other | st_shndx |                    |
+----------+----+----+----+----+----+----+----+----+----+----+----+----+---------+----------+----+-----+--------------------+
| 000000a0 |    |    |    |    |    |    |    |    | 00 |00  |00  | 00 | 03      |00        |01  |00   | *................* |
+----------+----+----+----+----+----+----+----+----+----+----+----+----+---------+----------+----+-----+--------------------+
|          | st_value                              | st_size                                           |                    |
+----------+----+----+----+----+----+----+----+----+----+----+----+----+---------+----------+----+-----+--------------------+
| 000000b0 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00      | 00       | 00 | 00  | *................* |
+----------+----+----+----+----+----+----+----+----+----+----+----+----+---------+----------+----+-----+--------------------+

This symbol does not have a name (name 0). The info is 3, STT_SECTION, so this
symbol refers to a section and its binding is local. And the section it refers
to is the section at index 1.

Symbol Entry 3
~~~~~~~~~~~~~~

+----------+----+----+----+----+---------+----------+----+-----+----+----+----+----+----+----+----+----+--------------------+
| address  |  0 |  1 |  2 |  3 |  4      |  5       |  6 | 7   |  8 | 9  | 10 | 11 | 12 | 13 | 14 | 15 | asccii             |
+==========+====+====+====+====+=========+==========+====+=====+====+====+====+====+====+====+====+====+====================+
|          | st_name           | st_info | st_other | st_shndx | st_value                              |                    |
+----------+----+----+----+----+---------+----------+----+-----+----+----+----+----+----+----+----+----+--------------------+
| 000000c0 | 00 | 00 | 00 | 00 | 03      | 00       | 02 | 00  | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | *................* |
+----------+----+----+----+----+---------+----------+----+-----+----+----+----+----+----+----+----+----+--------------------+
|          | st_size                                           |                                       |                    |
+----------+----+----+----+----+---------+----------+----+-----+----+----+----+----+----+----+----+----+--------------------+
| 000000d0 | 00 | 00 | 00 | 00 | 00      | 00       | 00 | 00  |    |    |    |    |    |    |    |    | *................* |
+----------+----+----+----+----+---------+----------+----+-----+----+----+----+----+----+----+----+----+--------------------+

This symbol does not have a name (name 0). The info is 3, STT_SECTION, so this
symbol refers to a section and its binding is local. And the section it refers
to is the section at index 2.

Symbol Entry 4
~~~~~~~~~~~~~~

+----------+----+----+----+----+----+----+----+----+----+----+----+----+---------+----------+----+-----+--------------------+
| address  |  0 |  1 |  2 |  3 |  4 |  5 |  6 | 7  |  8 | 9  | 10 | 11 | 12      | 13       | 14 | 15  | asccii             |
+==========+====+====+====+====+====+====+====+====+====+====+====+====+=========+==========+====+=====+====================+
|          |                                       | st_name           | st_info | st_other | st_shndx |                    |
+----------+----+----+----+----+----+----+----+----+----+----+----+----+---------+----------+----+-----+--------------------+
| 000000d0 |    |    |    |    |    |    |    |    | 00 |00  |00  | 00 | 03      |00        |03  |00   | *................* |
+----------+----+----+----+----+----+----+----+----+----+----+----+----+---------+----------+----+-----+--------------------+
|          | st_value                              | st_size                                           |                    |
+----------+----+----+----+----+----+----+----+----+----+----+----+----+---------+----------+----+-----+--------------------+
| 000000e0 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00      | 00       | 00 | 00  | *................* |
+----------+----+----+----+----+----+----+----+----+----+----+----+----+---------+----------+----+-----+--------------------+

This symbol does not have a name (name 0). The info is 3, STT_SECTION, so this
symbol refers to a section and its binding is local. And the section it refers
to is the section at index 3.

Symbol Entry 5
~~~~~~~~~~~~~~

+----------+----+----+----+----+---------+----------+----+-----+----+----+----+----+----+----+----+----+--------------------+
| address  |  0 |  1 |  2 |  3 |  4      |  5       |  6 | 7   |  8 | 9  | 10 | 11 | 12 | 13 | 14 | 15 | asccii             |
+==========+====+====+====+====+=========+==========+====+=====+====+====+====+====+====+====+====+====+====================+
|          | st_name           | st_info | st_other | st_shndx | st_value                              |                    |
+----------+----+----+----+----+---------+----------+----+-----+----+----+----+----+----+----+----+----+--------------------+
| 000000f0 | 00 | 00 | 00 | 00 | 03      | 00       | 05 | 00  | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | *................* |
+----------+----+----+----+----+---------+----------+----+-----+----+----+----+----+----+----+----+----+--------------------+
|          | st_size                                           |                                       |                    |
+----------+----+----+----+----+---------+----------+----+-----+----+----+----+----+----+----+----+----+--------------------+
| 00000100 | 00 | 00 | 00 | 00 | 00      | 00       | 00 | 00  |    |    |    |    |    |    |    |    | *................* |
+----------+----+----+----+----+---------+----------+----+-----+----+----+----+----+----+----+----+----+--------------------+

This symbol does not have a name (name 0). The info is 3, STT_SECTION, so this
symbol refers to a section and its binding is local. And the section it refers
to is the section at index 5.

Symbol Entry 6
~~~~~~~~~~~~~~

+----------+----+----+----+----+----+----+----+----+----+----+----+----+---------+----------+----+-----+--------------------+
| address  |  0 |  1 |  2 |  3 |  4 |  5 |  6 | 7  |  8 | 9  | 10 | 11 | 12      | 13       | 14 | 15  | asccii             |
+==========+====+====+====+====+====+====+====+====+====+====+====+====+=========+==========+====+=====+====================+
|          |                                       | st_name           | st_info | st_other | st_shndx |                    |
+----------+----+----+----+----+----+----+----+----+----+----+----+----+---------+----------+----+-----+--------------------+
| 00000100 |    |    |    |    |    |    |    |    | 00 |00  |00  | 00 | 03      |00        |04  |00   | *................* |
+----------+----+----+----+----+----+----+----+----+----+----+----+----+---------+----------+----+-----+--------------------+
|          | st_value                              | st_size                                           |                    |
+----------+----+----+----+----+----+----+----+----+----+----+----+----+---------+----------+----+-----+--------------------+
| 00000110 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00      | 00       | 00 | 00  | *................* |
+----------+----+----+----+----+----+----+----+----+----+----+----+----+---------+----------+----+-----+--------------------+

This symbol does not have a name (name 0). The info is 3, STT_SECTION, so this
symbol refers to a section and its binding is local. And the section it refers
to is the section at index 4.

Symbol Entry 7
~~~~~~~~~~~~~~

+----------+----+----+----+----+---------+----------+----+-----+----+----+----+----+----+----+----+----+--------------------+
| address  |  0 |  1 |  2 |  3 |  4      |  5       |  6 | 7   |  8 | 9  | 10 | 11 | 12 | 13 | 14 | 15 | asccii             |
+==========+====+====+====+====+=========+==========+====+=====+====+====+====+====+====+====+====+====+====================+
|          | st_name           | st_info | st_other | st_shndx | st_value                              |                    |
+----------+----+----+----+----+---------+----------+----+-----+----+----+----+----+----+----+----+----+--------------------+
| 00000120 | 08 | 00 | 00 | 00 | 11      | 00       | 02 | 00  | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 | *................* |
+----------+----+----+----+----+---------+----------+----+-----+----+----+----+----+----+----+----+----+--------------------+
|          | st_size                                           |                                       |                    |
+----------+----+----+----+----+---------+----------+----+-----+----+----+----+----+----+----+----+----+--------------------+
| 00000130 | 06 | 00 | 00 | 00 | 00      | 00       | 00 | 00  |    |    |    |    |    |    |    |    | *................* |
+----------+----+----+----+----+---------+----------+----+-----+----+----+----+----+----+----+----+----+--------------------+

This symbol name is located at offset 8 and is "name". The info is 11,
STT_OBJECT, and its binding is global (upper 4 bits are 0x1). And the section
it refers to is the section at index 2. It does not have a value but the size
is 0x6. If we go to `Section 2`_, we see that symbol points to the ascii string
"test\\n" which are 6 bytes.


Section 7
---------

name = 0x9
type = 3
flags = 0x3
address = 0
offset = 0x138
size = 0xd
link = 0
info = 0
align = 1
entry size = 0

The name is located at 0x145 + 0x9 = 0x14e (2e 73 74 72 74 61 62 00) or
".strtab".  The type is SHT_STRTAB, a symbol string table thus. The flags for
SHF_WRITE(1) and SHF_ALLOC(2) are set. The byte offset is 0x138 and the size is
0xd. The content is:

00 74 65 73 74 2e 63 00 6e 61 6d 65 00 or "test.c" and "name"

Summary
-------

All the information from above put together in one table results in the table
below.

+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
| address  |  0   |  1   |  2   |  3   |  4    |  5   |  6      |   7   |  8         |  9   |  10  | 11   | 12   | 13   |  14  | 15   | asccii interpretation |
+==========+======+======+======+======+=======+======+=========+=======+============+======+======+======+======+======+======+======+=======================+
|          | ELF Header `Elf Section Header Table`_                                                                                   |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
| 00000000 | 7F   | 45   | 4C   | 46   | 02    | 01   | 01      | 00    | 00         | 00   |  00  | 00   | 00   | 00   | 00   | 00   | *.ELF............*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          | ELF Header `Elf Section Header Table`_                                                                                   |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
| 00000010 |  01  |   00 |   3E |   00 |    01 |  00  |   00    | 00    | 00         |  00  |   00 |  00  |   00 |  00  |   00 |  00  | *..>.............*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          | ELF Header `Elf Section Header Table`_                                                                                   |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
| 00000020 |  00  |  00  |  00  |  00  |  00   | 00   | 00      | 00    |  90        |  01  |  00  |  00  |  00  |  00  |  00  |  00  | *................*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          | ELF Header `Elf Section Header Table`_                                                                                   |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
| 00000030 | 00   | 00   | 00   | 00   | 40    | 00   | 00      | 00    | 00         |  00  |  40  |  00  |  09  |  00  |  08  |   00 | *....@.....@.....*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          | `Section 2`_                             |  `Section 4`_                                                                 |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|00000040  |  74  |    65|   73 |   74 |    0A |   00 |   00    |  47   | 43         |    43|   3A |   20 |   28 |   55 |   62 |   75 | *test...GCC: (Ubu*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          | `Section 4`_                                                                                                             |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|00000050  |  6E  |   74 |  75  |  20  |   37  |  2E  |  33     | 2E    |30          |   2D |  32  |  37  |  75  |  62  |  75  |  6E  | *ntu 7.3.0-27ubun*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          | `Section 4`_                                                                                                             |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|00000060  |  74  |   75 |  31  |  7E  |   31  |  38  |  2E     | 30    |34          |   29 |  20  |  37  |  2E  |  33  |  2E  |  30  | *tu1~18.04) 7.3.0*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          |      |      unused (alignment requirements)                |  `Section 6`_                                               |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|00000070  |  00  |   00 |  00  |  00  |   00  |  00  |  00     | 00    |00          |   00 |  00  |  00  |  00  |  00  |  00  |  00  | *................*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          | `Section 6`_                                                                                                             |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|00000080  |  00  |   00 |  00  |  00  |   00  |  00  |  00     | 00    |00          |   00 |  00  |  00  |  00  |  00  |  00  |  00  | *................*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          | `Section 6`_                                                                                                             |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|00000090  |  01  |   00 |  00  |  00  |   04  |  00  |  F1     | FF    |00          |   00 |  00  |  00  |  00  |  00  |  00  |  00  | *................*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          | `Section 6`_                                                                                                             |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|000000A0  |  00  |   00 |  00  |  00  |   00  |  00  |  00     | 00    |00          |   00 |  00  |  00  |  03  |  00  |  01  |  00  | *................*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          | `Section 6`_                                                                                                             |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|000000B0  |  00  |   00 |  00  |  00  |   00  |  00  |  00     | 00    |00          |   00 |  00  |  00  |  00  |  00  |  00  |  00  | *................*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          | `Section 6`_                                                                                                             |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|000000C0  |  00  |   00 |  00  |  00  |   03  |  00  |  02     | 00    |00          |   00 |  00  |  00  |  00  |  00  |  00  |  00  | *................*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          | `Section 6`_                                                                                                             |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|000000D0  |  00  |   00 |  00  |  00  |   00  |  00  |  00     | 00    |00          |   00 |  00  |  00  |  03  |  00  |  03  |  00  | *................*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          | `Section 6`_                                                                                                             |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|000000E0  |  00  |   00 |  00  |  00  |   00  |  00  |  00     | 00    |00          |   00 |  00  |  00  |  00  |  00  |  00  |  00  | *................*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          | `Section 6`_                                                                                                             |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|000000F0  |  00  |   00 |  00  |  00  |   03  |  00  |  05     | 00    |00          |   00 |  00  |  00  |  00  |  00  |  00  |  00  | *................*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          | `Section 6`_                                                                                                             |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|00000100  |  00  |   00 |  00  |  00  |   00  |  00  |  00     | 00    |00          |   00 |  00  |  00  |  03  |  00  |  04  |  00  | *................*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          | `Section 6`_                                                                                                             |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|00000110  |  00  |   00 |  00  |  00  |   00  |  00  |  00     | 00    |00          |   00 |  00  |  00  |  00  |  00  |  00  |  00  | *................*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          | `Section 6`_                                                                                                             |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|00000120  |  08  |   00 |  00  |  00  |   11  |  00  |  02     | 00    |00          |   00 |  00  |  00  |  00  |  00  |  00  |  00  | *................*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          | `Section 6`_                                               | `Section 7`_                                                |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|00000130  |  06  |   00 |  00  |  00  |   00  |  00  |  00     | 00    |00          |   74 |  65  |  73  |  74  |  2E  |  63  |  00  | *.........test.c.*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          | `Section 7`_                      | `Section 8`_                                                                         |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|00000140  |  6E  |   61 |  6D  |  65  |   00  |  00  |  2E     | 73    |79          |   6D |  74  |  61  |  62  |  00  |  2E  |  73  | *name...symtab..s*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          | `Section 8`_                                                                                                             |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|00000150  |  74  |   72 |  74  |  61  |   62  |  00  |  2E     | 73    |68          |   73 |  74  |  72  |  74  |  61  |  62  |  00  | *trtab..shstrtab.*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          | `Section 8`_                                                                                                             |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|00000160  |  2E  |   74 |  65  |  78  |   74  |  00  |  2E     | 64    |61          |   74 |  61  |  00  |  2E  |  62  |  73  |  73  | *.text..data..bss*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          | `Section 8`_                                                                                                             |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|00000170  |  00  |   2E |  63  |  6F  |   6D  |  6D  |  65     | 6E    |74          |   00 |  2E  |  6E  |  6F  |  74  |  65  |  2E  | *..comment..note.*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|          | `Section 8`_                                                                                                             |                       |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+
|00000180  |  47  |  4E  |  55  |  2D  |  73   | 74   | 61      |  63   | 6B         | 00   | 00   | 00   | 00   | 00   | 00   | 00   | *GNU-stack.......*    |
+----------+------+------+------+------+-------+------+---------+-------+------------+------+------+------+------+------+------+------+-----------------------+


